<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />




<!-- waylon's adsense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6129496365361356"
     crossorigin="anonymous"></script>













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Weekly Blogs,Robotics,Paper," />










<meta name="description" content="[toc] 在 2018 年 3 月的亚利桑那州坦佩市，一辆 Uber 自动驾驶汽车撞死一名行人的事件至今让人们心有余悸，安全问题自那次事件之后饱受争议。   Uber 自动驾驶撞死行人事故  2020 年 10 月 末，自动驾驶领域的领跑者 -- Waymo，在其 官网 首次公开披露了其在凤凰城运营自动驾驶汽车的里程和碰撞数据，本文基于这份报告，提炼一些观点和数据。 报告传送门：Public R">
<meta property="og:type" content="article">
<meta property="og:title" content="解读 Waymo Public Road Safety Performance Data">
<meta property="og:url" content="http://www.waylon.one/AV/waymo-safety-report-2020/index.html">
<meta property="og:site_name" content="One&#39;s Way">
<meta property="og:description" content="[toc] 在 2018 年 3 月的亚利桑那州坦佩市，一辆 Uber 自动驾驶汽车撞死一名行人的事件至今让人们心有余悸，安全问题自那次事件之后饱受争议。   Uber 自动驾驶撞死行人事故  2020 年 10 月 末，自动驾驶领域的领跑者 -- Waymo，在其 官网 首次公开披露了其在凤凰城运营自动驾驶汽车的里程和碰撞数据，本文基于这份报告，提炼一些观点和数据。 报告传送门：Public R">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://www.waylon.one/downloads/images/blog/waymo_fleet.png">
<meta property="article:published_time" content="2021-01-21T14:10:19.000Z">
<meta property="article:modified_time" content="2023-05-16T14:34:59.463Z">
<meta property="article:author" content="Nobody">
<meta property="article:tag" content="Weekly Blogs">
<meta property="article:tag" content="Robotics">
<meta property="article:tag" content="Paper">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://www.waylon.one/downloads/images/blog/waymo_fleet.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.waylon.one/AV/waymo-safety-report-2020/"/>





  <title>解读 Waymo Public Road Safety Performance Data | One's Way</title>
  








<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">One's Way</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Dare to create</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.waylon.one/AV/waymo-safety-report-2020/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="One's Way">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">解读 Waymo Public Road Safety Performance Data</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-01-21T22:10:19+08:00">
                2021-01-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/AV/" itemprop="url" rel="index">
                    <span itemprop="name">AV</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  42k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  2:34
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[toc]</p>
<p>在 2018 年 3 月的亚利桑那州坦佩市，一辆 Uber
自动驾驶汽车撞死一名行人的事件至今让人们心有余悸，安全问题自那次事件之后饱受争议。</p>
<figure>
<img
src="http://www.waylon.one/downloads/images/blog/Uber_hit_cyclist.png"
alt="Uber 自动驾驶撞死行人事故" />
<figcaption aria-hidden="true">Uber 自动驾驶撞死行人事故</figcaption>
</figure>
<p>2020 年 10 月 末，自动驾驶领域的领跑者 -- Waymo，在其 <a
target="_blank" rel="noopener" href="https://waymo.com/safety">官网</a>
首次公开披露了其在凤凰城运营自动驾驶汽车的里程和碰撞数据，本文基于这份报告，提炼一些观点和数据。</p>
<p>报告传送门：<a
target="_blank" rel="noopener" href="https://storage.googleapis.com/sdc-prod/v1/safety-report/Waymo-Public-Road-Safety-Performance-Data.pdf">Public
Road Safety Performance Data</a></p>
<figure>
<img src="http://www.waylon.one/downloads/images/blog/waymo_fleet.png"
alt="Waymo 自动驾驶车队" />
<figcaption aria-hidden="true">Waymo 自动驾驶车队</figcaption>
</figure>
<p>在这份总结了过去 21 个月（2019 年全年和 2020 年前 9
个月）凤凰城郊区自动驾驶汽车运营报告中，Waymo 承认其自动驾驶汽车卷入了
18 起碰撞事故，还有 29 次是“差点出事故”（在模拟器中），并表示
“几乎所有”这些碰撞事件都是人类司机或行人的过错，而且没有造成任何“严重或危及生命的伤害。</p>
<p>报告将碰撞方式分为 “单车事件” 和“多车辆事件”，其中单车事件包含： 1.
涉及道路偏离、与道路环境 / 基础设施或其他固定对象接触的事件； 2.
涉及机动车辆行驶的事件，碰到行人或骑自行车的人； 3.
车辆被行人或骑自行车的人撞到的事件。</p>
<p>前两种情况相加，能占到致命碰撞贡献率的 60%。</p>
<p>多车辆事件则包括：</p>
<ol type="1">
<li>倒车碰撞</li>
<li>侧擦碰撞</li>
<li>正面碰撞</li>
<li>或对方逆行、追尾碰撞</li>
<li>在十字路口或拐角处的碰撞等等。</li>
</ol>
<p>在论文中，Waymo case by case 地概述了其他人类驾驶员的 “违反道路规则”
是如何导致 “严重” 碰撞的。</p>
<h1 id="专业名词介绍">专业名词介绍</h1>
<ul>
<li>automated vehicles (AVs)</li>
<li>automated driving system (ADS)</li>
<li>operational design domain (ODD)</li>
</ul>
<!--
- conflict-avoidance or collision-avoidance
- the Waymo vehicle was stopped or traveling straight in a designated lane at or below the speed limit.
- above the posted speed limit
- a dedicated left turn lane
- traffic controls or traffic conditions
- relative contact speeds 相对碰撞速度
- a speed bump
- slip lanes
- failed to obey the applicable traffic control device
-->
<h1 id="abstract">Abstract</h1>
<ul>
<li><p>这份报告总结了 Waymo 在凤凰城 (Phoenix) 测试区域的 610
万英里的自动驾驶测试数据，包括有车上安全员监管 ( trained operator behind
the steering wheel) 的自动驾驶，和 65000 英里的没有安全驾驶员无人驾驶
(driverless operation)。 &gt; The data presented in this paper
represents more than 6.1 million miles of automated driving in the
Phoenix, Arizona metropolitan area, including operations with a trained
operator behind the steering wheel from calendar year 2019 and 65,000
miles of driverless operation without a human behind the steering wheel
from 2019 and the first nine months of 2020.</p></li>
<li><p>报告中承认，这段测试期间 Waymo 自动驾驶汽车卷入了 18
起真实的碰撞事故和 29
次仿真事故(被安全驾驶员及时接管，但是在模拟器中发生碰撞事故)，所幸<strong>均没有造成致命伤害</strong>。
&gt; There were 47 contact events that occurred over this time period,
consisting of 18 actual and 29 simulated contact events, none of which
would be expected to result in severe or life-threatening
injuries</p></li>
<li><p>Waymo
表示，绝大多数事故都和人类驾驶员的不守规则和其他错误相关；由其他司机不谨慎行为诱发的事故频率清楚地提醒人们，只要自动驾驶汽车与人类司机共享道路，避免碰撞就是一大挑战。
&gt; Nearly all the events involved one or more road rule violations or
other errors by a human driver or road user. &gt; The presence of
collisions that resulted from challenging situations induced by other
drivers serves as a reminder of the limits of AV collision avoidance as
long as AVs share roadways with human drivers.</p></li>
<li><p>在 Waymo
看来，报告不只是向公众公开测试里程和事故，更是做了一个向公众分享自动驾驶行驶安全的一个例子。
&gt; The long-term contributions of this paper are not only the events
and mileages shared, but the example set by publicly sharing this type
of safety information.</p></li>
</ul>
<p>目前，很多自动驾驶的公司可能都在努力创造一个“黑匣子”，仅在最受控制的环境下向公众展示其技术领先性、跑了多少里程、拿了多少牌照，很少像
Waymo 这样向外界详细披露自动驾驶汽车在现实生活中短板，开始直面问题。</p>
<h1 id="introduction">Introduction</h1>
<ul>
<li>报告的目的是公开更多数据，来尽力提高公众对自动驾驶车辆的信心和接受程度
(acceptance)。 &gt; The purpose of this paper is to make available
relevant data to promote awareness and discussions that ultimately
foster greater public confidence in AVs.</li>
</ul>
<h2 id="public-road-testing">Public Road Testing</h2>
<ul>
<li>在测试初期，为了保证 AVs
在公开道路测试时的安全和行为合理，会有经过培训的驾驶员坐在驾驶员的位置，随时准备接管车辆。
&gt; In order to perform initial public road testing of AVs in a safe
and responsible manner, trained vehicle operators are seated in the
driver’s seat and can take over the driving task at any time.</li>
</ul>
<h2 id="the-role-of-counterfactual-what-if-simulation">The Role of
Counterfactual (“What If”) Simulation</h2>
<p>Waymo
统计了经过培训的安全驾驶员控制车辆以避免碰撞的事件，然后工程师们会模拟如果驾驶员没有接管车辆自动驾驶系统的话会发生什么，从而产生一个反事实或
“假设”
出来的推断情景。他们利用这些事件来不断检验调整汽车的临场决策反应，然后利用这些数据改进其自动驾驶软件。</p>
<ul>
<li><p>反现实的仿真用来预测自车在接管后的一段时间内的表现，给我们提供如果安全员没有接管，那么自车会发生什么的视角。
&gt; Counterfactual disengagement simulation is used to represent the
predicted vehicle response for a brief period (seconds) after
disengagement, and the simulation outcome provides insight into what
could have happened had the trained operator not intervened. &gt; MC:
只能提供极短时间的仿真，否则容易和真实世界背离。另外，需要有精细的模型，可以预期如果没有接管发生，交通参与者的行为。</p></li>
<li><p>反事实的接管仿真可以独立使用 (individually) 也可以聚合使用 (in
aggregate)。 &gt; The outcomes of counterfactual disengagement
simulations are used both individually and in aggregate.</p>
<ul>
<li>独立仿真时间：场景库的虚拟仿真，可以作为评估软件开发的测试集。 &gt;
Individual counterfactual disengagement simulation: If the simulation
outcome reveals an opportunity to improve the behavior of the ADS, then
the simulation is used to develop and test changes to software
algorithms. The disengagement event is also added to a library of
scenarios, so that future software can be tested against the scenario.
&gt;
在细分领域，自动驾驶的策略会随着接管场景而发生调整和变化，容易造成回滚，而这些场景集合可以作为软件的回滚测试的一部分。</li>
<li>聚合使用：评估 AVs 的路测表现。 &gt; At an aggregate level, Waymo
uses results from counterfactual disengagement simulations to produce
metrics relevant to the AV’s on-road performance.</li>
</ul></li>
<li><p>软件进化带来的仿真不可复现性问题 &gt; Waymo’s models will
continue to evolve, and even for these brief simulations, future models
may result in different simulated outcomes.</p></li>
</ul>
<!--
> 甩锅句子，仿真如何和描述不符，那是算法更新导致的。
-->
<h2 id="aims-and-contributions-of-this-paper">Aims and Contributions of
this Paper</h2>
<ul>
<li><p>报告包括在 610 万英里测试中的事故总计和事故描述
(包括真实的事故和实际接管但发生仿真事故)。这部分里程，相当于美国普通持证司机
500 多年的驾驶里程。 &gt; This paper includes safety data in the form of
event counts and event descriptions from over 6.1 million miles of
driving conducted in the Waymo Driver’s driverless ODD. This mileage
figure represents over 500 years of driving for the average U.S.
licensed driver.</p></li>
<li><p>本文提供了两种信息：一种是在或无安全驾驶员情况下的真实碰撞（actual
contact
event）；一种是驾驶员接管，但是在后续的仿真中发生碰撞的，但是因为安全员接管实际没有发生碰撞。
&gt; For these miles, this paper provides information regarding</p>
<ol type="1">
<li>every actual contact event that vehicles were involved in during
driverless operation with and without trained operators, as well
as<br />
</li>
<li>events in which the vehicle’s trained operator disengaged and
subsequent counterfactual simulation resulted in any contact between the
AV and the other agent, had the disengagement not occurred</li>
</ol></li>
</ul>
<p>在 2019 年 1 月至 12 月期间，Waymo 在自动驾驶模式下行驶了 610
万英里。从 2019 年 1 月到 2020 年9 月期间，Waymo 在无人驾驶模式下行驶了
6.5 万英里。该公司表示，综合来看这相当于“美国普通持证司机 500
多年的驾驶时间”。</p>
<h1 id="methods">Methods</h1>
<h2 id="data-sources">Data sources</h2>
<ul>
<li>Waymo 自动驾驶软件的最高速度是 45 英里每小时，换算成公里数是
72.4km/h。除了大雨和沙尘暴天气，会在白天和夜间进行无人驾驶测试。 &gt;
The ODD includes roadways with speed limits up to and including 45 miles
per hour. Driverless operations occur at all times day and night, except
during inclement weather including heavy rain and dust storms.</li>
</ul>
<!--

45 miles/h =  72.4km/h

-->
<p>报告分享的数据来源于两方面： - 无人驾驶（Driverless
operation），即车上没有驾驶员，在整个过程中由自动驾驶系统 (automated
driving system) 控制车辆。 &gt; Driverless operation, in which the
automated driving system controls the vehicle for the entire trip
without a human driver behind the wheel or otherwise being available to
<strong>assume</strong> any part of the driving task.<br />
&gt; MC: 这种模式下，在 2019 年初到 2020 年九月底的测试里程是 6.5
万英里。</p>
<ul>
<li>由驾驶员的自动驾驶（Self-driving with trained
operators）：虽然由自动驾驶系统控制车辆，但是车上有安全驾驶员可以随时接管车辆。
&gt; Self-driving with trained operators , in which the automated
driving system controls the vehicle but there is a trained vehicle
operator in the driver’s seat who can disengage and take over the
driving task.<br />
&gt; MC: 这种模式下，2019 年全年的测试里程是 6.1
百万里程。提供一整年的测试数据，可以控制和规避潜在的季节影响
(controlling for potential seasonality
effects)。在评估自车表现时，不能忽略季节影响，比如秋天有落叶误感，方向盘急打要比冬季严重。</li>
</ul>
<h2 id="data-from-actual-collisions-and-minor-contacts">Data from Actual
Collisions and Minor Contacts</h2>
<ul>
<li>数据包括自动驾驶 (self-driving with trained operators mode)
或无人驾驶 (driverless mode) 模式下每一个真实碰撞 (actual collision)
和小事故 (minor contact event)，甚至包括行人撞上静止自车的事故。 &gt;
This definition encompasses not only every severity of collision, but
also events such as a pedestrian walking into the side of the stationary
AV.</li>
</ul>
<!--
- 难以相信，怎么还有行人撞上静止自车的情况呢？
-->
<h2 id="data-from-counterfactual-what-if-simulation">Data from
Counterfactual (“What If”) Simulation</h2>
<h3 id="simulation-of-the-av-motion-post-disengagement">Simulation of
the AV motion post-disengagement</h3>
<ul>
<li>接管后的仿真 (post-disengage simulation) 第一步，就是仿真自车的表现
(AV’s counterfactual post-disengage
motion)。这样的仿真比较简单，容易快速实现。 &gt; The first step in
post-disengage simulation is therefore to simulate the AV’s
counterfactual post-disengage motion. &gt; This is performed by
providing a simulation running Waymo self-driving software with the AV’s
pre-disengage position, attitude, velocity, and acceleration along with
the AV’s recorded sensor observations and simulating the response of the
software and resulting motion of the Waymo vehicle.</li>
</ul>
<!--

条件状bai语从句中的虚拟语du气，对过去zhi的虚拟，had提前dao，省掉if
- (If sb) had done sth, sb would have not done.
  * 如果某人做了bai...，某人就不会...，例句：
- If he had taken my advice, he wouldn't have failed. 

or

- Had he taken my advice, he wouldn't have failed.

-->
<ul>
<li><p>检测是否和其他交通参与者有碰撞，重叠的位置 (overlapping
positions) 意味着有潜在的碰撞 (potential collision)。 &gt; Overlapping
positions indicate a potential collision. After the AV’s post-disengage
motion is simulated, a check is performed to determine if the simulated
positions of the AV overlap at any point with the recorded positions of
other agents.</p></li>
<li><p>仿真第二步：在接管和仿真两种情况下，自车的行为存在不一致
(比如位置和速度不一样)，那么就会影响其他参与者的行为，所以做仿真时，参与者的行为可能和实际不符，需要为其他交通参与者重新建模
(modeling the behavior of other
agents)。这是比较困难的，需要有比较丰富的模型和交互设计。 &gt; This may
not be <strong>realistic</strong> in cases where the other agents would
likely have responded differently to the AV’s counterfactual simulated
motion than they did to the AV’s actual post-disengage motion. In such
cases, further simulation is required.</p></li>
<li><p>总结一下，接管后的仿真，不仅需要使用恰当的软件，仿真自车的行为，也需要仿真其他交通参与者的行为，而这是比较困难的。</p></li>
</ul>
<h3 id="modeling-of-other-agents">Modeling of other agents</h3>
<ul>
<li><p>为其他交通参与者长时间建模是比较有挑战性的，但是在接管后的短时间内建立冲突避免
(conflict-avoidance) 或避障行为 (collision-avoidance) 是可行的做法。
&gt; While modeling agent behavior over long periods of time is
challenging, understanding plausible conflict-avoidance or
collision-avoidance behavior over the short time horizon following a
disengagement is a more feasible task.</p></li>
<li><p>Waymo 使用人类避障行为模型 (human collision avoidance behavior
models)
来反映短期内障碍物的表现；可以使用离散的多因素(反应时间、刹车和打方向盘的力度)来反映交通参与者可行的反应空间
(the space of plausible reactions)。 &gt; Waymo expresses short-term
agent responses using human collision avoidance behavior models. &gt;
These models aim to capture the responses of human drivers,
motorcyclists, cyclists, and pedestrians to collision avoidance
situations, such as braking by a lead vehicle or being cut-off by
another agent who fails to yield right-of-way. &gt; Because only the
agent’s short-term response needs to be modeled, the space of plausible
reactions to such stimuli can be defined using <strong>a discrete set of
factors</strong> such as response times to specific inputs and brake or
swerve ability.</p></li>
<li><p>因为上述的多因素因环境因人而异(比如反应时间)，Waymo 在开发和评估
AV 行为时，使用一个范围来表示可能的人类驾驶表现 (a broad spectrum of
potential human driving performance).
为了透明度和简单性，本文使用确定的模型 (deterministic model)
来对一个给定的输入产生给定的输出。 &gt; Waymo considers a broad spectrum
of potential human driving performance in developing and evaluating the
AV, but for transparency and simplicity, the results reported in this
paper are based on deterministic models that generate a single response
to a given input.<br />
&gt; Other methods can be used to capture a range of possible human
responses, such as probabilistic counterfactual outcomes, but they are
more complex.</p></li>
</ul>
<!--
- 他碰上我不应该；就算我的行为不合理，他有避碰的动机和趋势
-->
<ul>
<li><p>Waymo 独有的人类避碰模型是基于现在已有的道路使用者的行为模型
(road user behavior modelling frameworks)，并基于人类自然的避碰模型
(naturalistic human collision) 和差点碰撞的数据 (near-collision)
来校正。 &gt; Waymo’s proprietary human collsion avoidance behavior
models are based on existing road user behavior modelling frameworks and
calibrated using naturalistic human collision and near-collision
data.</p></li>
<li><p>交通参与者的反应被其刹车和转向性能所限制。Waymo
针对不同类型的交通参与者以及不同的触发场景 (different
stimuli)，使用不同的模型。 &gt; The agent’s response is further
constrained by human braking and steering limitations. Waymo uses
different models for different types of agents, including <strong>heavy
trucks</strong>, pedestrians, and cyclists, and for different stimuli
such as a forward agent braking or an agent emerging from behind an
occlusion.<br />
&gt; MC:
如果单车智能比较高，贴近于人类驾驶员的表现，那么是否可以使用自动驾驶软件的算法模拟车辆的行为；也就是说其他车和自车的表现拟合度比较高，能否使用自车模型来仿真其他车的表现呢？</p></li>
</ul>
<!-- 

参考这些文献，可以用于自己的开发工作中
  
[7] Engström J, Bärgman J, Nilsson D, et al. Great expectations: a predictive processing account of automobile driving, Theoretical Issues in Ergonomics Science , 2018; 19:2, 156-194, DOI: 10.1080/1463922X.2017.1306148
[8] Markkula G, Engström J, Lodin J, Bärgman J, Victor T. A farewell to brake reaction times? Kinematics-dependent brake response in naturalistic rear-end emergencies. Accident Analysis & Prevention , 2016; 95, 209-226.
-->
<ul>
<li>人类避碰模型的使用场合和条件：当仿真接管后的 AV
轨迹和交通参与者的实际轨迹有重叠，那么就会在接管后的仿真中使用人类避障模型
(human collision avoidance behavior models)。 &gt; Human collision
avoidance behavior models are employed for disengagements in which there
is overlap between the simulated post-disengage trajectory of the AV and
the actual post-disengage trajectory of another agent.<br />
&gt; In these cases, instead of using the agent’s recorded
post-disengage trajectory, the post-disengage trajectory of the other
agent is determined by applying the relevant human collision avoidance
behavior model.</li>
</ul>
<h3 id="contact-analysis-of-simulated-collisions">Contact analysis of
simulated collisions</h3>
<ul>
<li>Waymo
仿真分析表明，接管很少会造成实际上的碰撞(大部分是防御性接管)。事实上，超过
99% 的接管没有仿真的接触 (simulated contact) 发生。 &gt; Our simulation
analysis indicates that disengagements would rarely result in contact.
In fact, in more than 99.9% of disengagements, no simulated contact is
found to occur.<br />
&gt; MC: 因为 Waymo
的软件开发程度比较高，才可以有这样的把握；对于初创期的软件，没有充分的道路测试，切不可使用这样的结论。</li>
</ul>
<p>Waymo
根据伤害可能性、碰撞物体、撞击速度和撞击几何结构分析，以确定某些事故的严重性，。</p>
<ul>
<li>如何碰撞发生，那么如何确定碰撞的严重程度 (event severity) 呢？Waymo
根据碰撞障碍物的类型 (collision object)，相对速度 (impact velocity)
和碰撞位置 (impact geometry) 来确定可能的伤害程度 (likelihood of
injury)。Waymo 使用国家碰撞数据库 (national crash databases)
来为事故严重程度分级 (event severity
category)，事件的统计等级分为预计无伤害 (S0) 到可能的严重伤害 (S1、S2 和
S3)。 &gt; This determination categorizes collisions based on likelihood
of injury and is based on the collision object (e.g., other vehicles,
static objects, or vulnerable road users such as pedestrians or
cyclists), impact velocity, and impact geometry.<br />
&gt; Waymo’s methods for determining event severity category are
developed using national crash databases and are periodically refined to
reflect updated data.</li>
</ul>
<h1 id="results-collisions-and-minor-contacts">Results: Collisions and
Minor Contacts</h1>
<figure>
<img
src="http://www.waylon.one/downloads/images/blog/classification_of_waymo_collisions.PNG"
alt="Collision Categories" />
<figcaption aria-hidden="true">Collision Categories</figcaption>
</figure>
<p>上表中的碰撞类型<strong>列</strong>分类 (collision typology)
是根据美国国家机构的专业分类 (using the Manner of Collision categories
from National Highway Traffic Safety Administration (NHTSA) collision
databases such as the Fatality Analysis Reporting System);
碰撞程度<strong>行</strong>分类是基于国际标准 ISO 26262
来评估碰撞的严重程度，从没有伤害的 S0 (no injury expected)
到有关键伤害的 S3 (possible critical injuries
expected)，碰撞的伤害逐渐增大。 &gt; categorized in rows according to
their collision typology using the <strong>Manner of Collision</strong>
categories from National Highway Traffic Safety Administration (NHTSA)
collision databases such as the Fatality Analysis Reporting
System.<br />
&gt; columns categorized by estimated event severity using the ISO 26262
severity classes: S0, S1, S2, and S3, ranging from no injury expected
(S0) to possible critical injuries expected (S3). * MC:
虽然中美两国的交通法规和驾驶习惯不同，但是这样的交通事故分类是可以拿来参考的。</p>
<p>Waymo 报告中的碰撞事故中，没有 S2 或 S3 级别事故发生，最严重的事故是
S1 级别 (airbag-deployment-level)，有 3 次保护气囊弹出。 &gt; There were
no actual or predicted S2 or S3 events. One actual event involved
deployment of another vehicle’s frontal airbags and the Waymo vehicle’s
side airbags.</p>
<p>Waymo
通过和人类的事故相比较，来表明其自动驾驶软件在减少人员伤亡上的可能性。
&gt; Comparison between these human collision statistics and Waymo event
counts provides insight into the Waymo Driver’s opportunity for reducing
injuries and fatalities due to collisions.</p>
<ul>
<li>In total, the Waymo vehicle was involved in 20 events involving
contact with another object and experienced 27 disengagements that
resulted in contact in post-disengagement simulation, for a total of 47
events (actual and simulated).
<ul>
<li>我的困惑点：上述表格中统计的实际碰撞是 18 次，仿真碰撞是 29 次，这和
Waymo 的文字描述是不统一的 (实际碰撞 20 次，虚拟碰撞 27
次)；那么是有数据修正吗，还是我粗心搞错了呢？</li>
</ul></li>
</ul>
<p>报告以图片形式 (diagrams have been provided)，重点关注了 3
个和弱势交通群体的交互事故，以及 8 个有安全气囊弹出的严重事故。 &gt;
Specifically, diagrams have been provided for every actual or simulated
event in which a pedestrian or cyclist was involved (three events) and
every event with actual or simulated airbag deployment for any involved
vehicle (eight events).</p>
<h2 id="single-vehicle-events">Single Vehicle Events</h2>
<p>根据 Manner of Collision 的分类标准，交通事故可以分为单车事故 (single
vehicle events) 和多车事故 (multiple-vehicle events)。 &gt; The Manner
of Collision categories within the NHTSA crash database can be broadly
classified as either single vehicle events, which involve a single
motorized vehicle in transport, or multiple-vehicle events, which
involve the impact of at least two motorized vehicles in transport.</p>
<!--
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">graph LR</span><br><span class="line">A[single-vehicle Manner]-\\-&gt;B(events that involve road departure, contact with the roadway environment/infrastructure or other fixed objects, or single-vehicle rollover)</span><br><span class="line">A-\\-&gt;C(events involving the motorized vehicle striking a pedestrian or bicyclist)</span><br><span class="line">A-\\-&gt;D(events involving the motorized vehicle being struck by a pedestrian or bicyclist)</span><br></pre></td></tr></table></figure>
<p>--&gt;</p>
<!---->
<p>Waymo 自动驾驶车辆没有发生偏离车道 (road departure)
和撞上行人的单车事故 (struck a pedestrian or
cyclist)；而这类事故在人类驾驶数据中占比约为 60%。 &gt; The Waymo Driver
did not have any events (actual or simulated) in this data that involved
road departure, contact with the roadway environment/infrastructure or
other fixed objects, or rollover. There were also no collisions (actual
or simulated) in which the Waymo Driver struck a pedestrian or
cyclist.</p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_1.jpg" /></p>
<p>Waymo 在减速或者静止时，被行人或滑板车从右侧撞上。 &gt; In each
instance, the Waymo Driver decelerated and stopped, and a pedestrian or
cyclist <strong>made contact with</strong> the right side of the
stationary Waymo vehicle while the pedestrian or cyclist was traveling
<strong>at low speeds</strong>. *
MC：我怀疑自车突然急刹，行人来不及反应而撞上去。</p>
<h2 id="multiple-vehicle-events-reversing-reversing">Multiple Vehicle
Events: Reversing Reversing</h2>
<p>倒车碰撞 (reversing collisions)
事故经常发生在停车场，很少出现在交警报告数据库中。 &gt; Reversing
collisions (e.g., rear-to-front, rear-to-side, rear-to-rear) are usually
associated with parking lot events or occur on local ( ≤ 25 mph)
roadways and do not frequently appear in databases of police-reported
crashes.</p>
<p>In both scenarios, the Waymo vehicle was <strong>stopped or traveling
forward</strong> at low speed and the other vehicle was reversing at a
speed of less than 3 mph at the moment of contact to the side of the
Waymo vehicle.</p>
<h2 id="multiple-vehicle-events-same-direction-sideswipe">Multiple
Vehicle Events: Same Direction Sideswipe</h2>
<p>同方向剐蹭 (sideswipe) 主要发生在变道 (lane changing) 和并道 (lane
merging) 行为时。 &gt; These events are typically experienced during
lane changing or merging maneuvers.<br />
&gt; The Waymo Driver was involved in <strong>ten simulated</strong>
same direction sideswipe collisions.</p>
<h3 id="other-vehicle-changing-lanes-waymo-vehicle-straight">Other
vehicle changing lanes, Waymo vehicle straight</h3>
<p>The other vehicle <strong>changed lanes into</strong> the area
occupied by the Waymo vehicle, which resulted in simulated or actual
<strong>sideswipe collisions</strong>.</p>
<h3 id="other-vehicle-straight-waymo-vehicle-changing-lanes">Other
vehicle straight, Waymo vehicle changing lanes</h3>
<p>In both of these simulations, the Waymo Driver made a <strong>lateral
movement</strong> in front of a vehicle traveling straight <strong>in an
adjacent lane</strong>.</p>
<h2
id="multiple-vehicle-events-head-on-or-opposite-direction-sideswipe">Multiple
Vehicle Events: Head-on or Opposite Direction Sideswipe</h2>
<p>对头碰撞极易发生严重的交通事故 (high severity)。 &gt; Head-on
collisions have the potential for high severity outcomes.</p>
<p>不能期待驾驶员是理性的，或者一定会有避碰动作：道路情况复杂，你永远不知道司机是什么状态，可能是车辆失控
(impaired) 或疲劳驾驶 (fatigued) 等异常情况。 &gt; <strong>The absence
of simulated collision avoidance movement by the other vehicle</strong>
reflects our assumption based on driving behavior and circumstances that
the other driver was significantly impaired or fatigued.</p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_2.jpg" /></p>
<p>如何区别示意图中哪部分是真实，哪部分是仿真的：actual collisions are
represented in color, while simulated ones feature a black and white
background. Solid trajectory lines represent those observed in real
life, while dashed trajectories and shaded poses represent simulated
conditions. Diagrams are intended for visual reference only, and are not
drawn to scale.</p>
<h2 id="multiple-vehicle-events-rear-end">Multiple Vehicle Events: Rear
End</h2>
<p>追尾碰撞 (rear end collisions) 是最常见的人类驾驶员的碰撞行为。 &gt;
Rear End collisions are the most common collision type in human-driven
collisions.<br />
&gt; The Waymo Driver was involved in fourteen actual and two simulated
rear end collisions</p>
<!--
- 自车被后方超速车辆追尾
- 自己右转时，避让交通参与者，被后方车辆追尾
-->
<h3
id="rear-end-struck-event-group-waymo-vehicle-stopped-or-gradually-decelerating-for-traffic-controls-or-traffic-ahead-while-traveling-straight">Rear
end struck event group, Waymo vehicle stopped or gradually decelerating
for traffic controls or traffic ahead while traveling straight</h3>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_3.jpg" /></p>
<p>上面的事故，是唯一一个发生在没有安全驾驶员的无人驾驶模式下
(driverless mode)。 &gt; Sole collision in driverless mode, without a
trained operator in the driver’s seat.</p>
<h3
id="rear-end-struck-event-group-waymo-vehicle-moving-slower-while-traveling-straight">Rear
end struck event group, Waymo vehicle moving slower while traveling
straight</h3>
<p>In the other collision, the Waymo vehicle, traveling straight at the
speed limit, was struck by a vehicle traveling 23 (57-35) mph
<strong>over the posted speed limit</strong>.</p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_4.jpg" /></p>
<h3 id="rear-end-struck-event-group-in-right-turning-maneuvers">Rear end
struck event group in right turning maneuvers</h3>
<p>These collisions occurred while the Waymo was stationary or near
stationary waiting for crossing traffic to clear after <strong>having
gradually slowed to account for this traffic</strong>.</p>
<h3
id="rear-end-struck-event-with-braking-of-lead-vehicle-during-left-turn">Rear
end struck event with braking of lead vehicle during left turn</h3>
<ul>
<li>自车在路口左转急刹停 (a deceleration to a near
stop)，后面车辆跟车距离不够来不及刹车。 &gt; The remaining rear end
struck collision involved a deceleration to a near stop by the Waymo
Driver while making a left turn in an intersection with a following
vehicle that was traveling at a speed and <strong>following distance
that did not allow for the following driver</strong> to successfully
respond to the Waymo Driver’s braking.</li>
</ul>
<h3 id="rear-end-striking-event">Rear end striking event</h3>
<p>背景车有挑衅行为 (antagonistic
motive)，在前方没有障碍物的情况下，故意插入 (cut in) 自车前方后急刹
(braked hard
immediately)，自车来不及急刹，从后方撞上。这是唯一一起在仿真中，自车追尾其他车的事故。
&gt; The single simulated event in this grouping involved a vehicle that
<strong>swerved into</strong> the lane in front of the Waymo and braked
hard immediately after cutting in despite lack of any obstruction ahead
(consistent with antagonistic motive).</p>
<h2 id="multiple-vehicle-events-angled">Multiple Vehicle Events:
Angled</h2>
<p>Angled collisions, those that are typically seen at intersections and
involve crossing or turning vehicles, account for approximately
<strong>one quarter</strong> of all human-driven collisions and a
similar fraction of the contribution to all human-driven fatalities.</p>
<h3
id="angled-event-group-with-the-other-vehicle-not-yielding-to-waymo-right-of-way">Angled
event group with the other vehicle not yielding to Waymo
right-of-way</h3>
<p>The collisions in this grouping (ten simulated, one actual) involve
<strong>the Waymo vehicle traveling straight in a designated
lane</strong> at or below the speed limit. In all scenarios, the
turning/crossing other vehicle either disregarded traffic controls or
otherwise <strong>did not properly yield right-of-way</strong>.</p>
<p>路权的定义： &gt; Right-of-way is determined based on <strong>the
positions of vehicles prior to contact</strong> with respect to the
<strong>intersection geometry</strong>, roadway markings, and the status
of traffic control devices. Right-of-way is useful as a means of
categorizing some events, but <strong>it can be insufficient to
determine collision responsibilities</strong> since it does not reflect
all road rule violations (e.g. speeding), nor does it provide
information regarding collision avoidability.</p>
<p>为了减少碰撞风险，Waymo 车辆即使在有路权时也会让行 (yielding)。 &gt;
In order to avoid collisions, the Waymo Driver recognizes that
<strong>yielding even when the Waymo vehicle is entitled to right-of-way
may be more appropriate to decrease the risk of collision</strong>, for
example when encountering an incautious other agent.</p>
<p>In both instances, when the simulated Waymo Driver became aware of
the other vehicle's intention to enter the travel lane, the simulated
Waymo Driver initiated braking in an attempt to avoid/mitigate impact. *
如果检查到其他车不让行，那么 Waymo 自车会开始刹车来避免碰撞。</p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_5.jpg" /></p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_6.jpg" /></p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_7.jpg" /></p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_8.jpg" /></p>
<p>上面这个碰撞不常见，需要认真思考下。</p>
<p><img
src="http://www.waylon.one/downloads/images/blog/Waymo_safety_9.jpg" /></p>
<p>左转车辆应该礼让直行车辆，如果不礼让，怎么办呢？ Waymo
目前的做法也只能是安全员接管。 &gt; The simulated collision in Figure 9
(Event H) depicts a vehicle making a left turn across the Waymo
vehicle’s travel path. The Waymo Driver’s simulated response to the
vehicle’s action was the initiation of braking just prior to entering
the intersection.</p>
<p>这是最严重的一类碰撞事故 (the most severe collision)。 &gt; It is the
most severe collision (simulated or actual) in the dataset and
approaches the boundary between S1 and S2 classification.</p>
<!--
- Based on the vehicle masses and simulated vehicle speeds and **geometry at impact**, this event is categorized as S1 with expected airbag deployment.

In sum, the collisions in this angled event grouping (ten simulated, one actual) were characterized by the other vehicle failing to yield right-of-way to the Waymo vehicle, and they involved the Waymo vehicle traveling straight with the right-of-way, with a speed at or below the speed limit.
-->
<h2
id="angled-event-group-with-waymo-vehicle-crossing-another-vehicles-path">Angled
event group with Waymo vehicle crossing another vehicle’s path</h2>
<p>The collisions in this grouping involve <strong>four</strong>
simulated collisions, where the Waymo Driver was making a right turn
from a rightmost lane that was either splitting to an additional lane,
or had been the result of two lanes merging to one.</p>
<p>Waymo
向右变道时和右侧车道的直行车辆发生碰撞，类似于国内的自车右转，与自行车道的交互。
&gt; In each event, a passenger vehicle attempted to pass the Waymo
vehicle on the right while the Waymo Driver was slowing to make the
right turn <strong>with the right turn signal activated</strong>.</p>
<h1 id="discussion">Discussion</h1>
<p>这份报告的目的是：供工业界，政策制定者和公众学习；促进关注和讨论，以及加快公众对自动驾驶的接受程度。
&gt; The goal of this transparency is to contribute to broad learning
with the industry, policymakers, and the public; promote awareness and
discussions; and foster greater public confidence in automated
vehicles.</p>
<p>Of the fifteen angled events, eleven events were characterized by the
other vehicle failing to properly yield right-of-way to the Waymo
vehicle traveling straight at or below the speed limit. &gt; MC:
针对自车有路权，其他车辆不让行的情况，Waymo
也依赖安全驾驶员及时接管。</p>
<h2
id="collision-avoidance-management-of-human-driver-related-contributing-factors">Collision
Avoidance: Management of Human-Driver-Related Contributing Factors</h2>
<ul>
<li><p>人类驾驶行为的不稳定性和不安全性，导致了绝大多数的碰撞。几乎所有的事故都是因为其他交通参与者违背交通规则或者交通表现有偏差。
&gt; Humans exhibit a large variation of driving behaviors including
<strong>deviations from traffic rules and safe driving
performance</strong> that can lead to collisions.<br />
&gt; Nearly all events summarized above involved one or more road rule
violations or other driving performance deviations by another
<strong>road user</strong>.</p></li>
<li><p>Waymo
在努力实现不因为自身原因造成碰撞的同时，也尽量减少因为人类走神
(inattention)，激进驾驶 (aggressive driving) 和超速 (speeding)
带来的可能碰撞。 &gt; In addition to Waymo's key focus on not causing
collisions, Waymo also works to mitigate possible collisions due to
human behaviors such as inattention, aggressive driving, and
speeding.</p></li>
<li><p>Although many of these situations would not be present in a
future with a high proportion of AVs, we envision sharing roads with
human drivers for the foreseeable future. <strong>The rare contact
events described in this paper are used to develop enhanced collision
avoidance to improve traffic safety</strong>, and we will continue to
focus on enhancing avoidance of human-induced collisions. &gt;
这些场景在道路上不常见，但是也无法避免，自动驾驶同行可以反思遇到的这些
corner cases.</p></li>
<li><p>Waymo 在努力减少事故发生的可能性
(likelihood)，而不仅仅是避免碰撞。自车的行为，要能够被其他交通参与者
(other road users) 可判断 (interpretable) 和可预测 (predictable)。 &gt;
Beyond collision avoidance, Waymo also continually investigates
improvements to the Waymo Driver’s behaviors to reduce the likelihood of
conflict with human-driven vehicles and other road users.<br />
&gt; This illustrates a key challenge faced by AVs operating in a
predominantly human traffic system and <strong>underscores the
importance of driving in a way that is interpretable and predictable by
other road users</strong>.</p></li>
<li><p>相比于人类，Waymo
的自动驾驶能力是可以不断提升的，适用到整个车队上。 &gt; Unlike human
drivers, who primarily improve through <strong>individual
experience</strong>, the learnings from an event experienced by a single
AV can be used to permanently improve the safety performance of
<strong>an entire fleet of AVs</strong>.</p></li>
</ul>
<h2 id="aggregate-safety-performance">Aggregate Safety Performance</h2>
<p>Waymo 车辆在单车表现 (single-vehicle collision typology) 和 追尾问题
(rear-end collisions) 上的良好表现，已经优于人类。 &gt; The Waymo Driver
experienced zero actual or simulated events in the “road departure,
fixed object, rollover” single-vehicle collision typology, reflecting
the system's ability to navigate the ODD in a highly reliable
manner.<br />
&gt; In addition, while rear-end collisions are one of the most common
collision modes for human drivers, the Waymo Driver only recorded
<strong>a single front-to-rear striking collision</strong> (simulated)
and this event involved an agent cutting in and immediately braking
without allowing for adequate separation distance (consistent with
antagonistic motive).</p>
<h3 id="lower-severity-collision-risk">Lower-severity collision
risk</h3>
<p>无论是人类驾驶员，还是自动驾驶车辆，轻微事故 (lower-severity events)
发生的频率要高于严重事故 (higher-severity) 的发生频率。 &gt; In both
human-driven and automated vehicles, lower-severity events (S0 and S1)
occur at significantly higher frequency than higher-severity (S2 and S3)
events. As a result, fewer miles are needed to draw statistical
conclusions about S0 and S1 rates.<br />
&gt; When comparing driving data, the mileage needed to reveal
<strong>statistically significant differences also depends on the
magnitude of the differences in the actual rates</strong> being
compared.</p>
<p>For a given metric, the larger the difference in performance, the
fewer miles that are required to establish <strong>statistical
confidence</strong> in a hypothesis of non-inferiority or
superiority.</p>
<p>如何统计和判责 &gt; low-severity data, when evaluated in the context
of each event’s collision geometry, may be informative of high-severity
risk.</p>
<p>现有的道路公开测试，可以为 S0 or S1 提供统计上的支持 (sufficient
statistical signal)。 &gt; The 6.1 million miles in self-driving with
trained operators mode underlying the data in Section 3 <strong>provide
sufficient statistical signal to detect moderate-to-large differences in
S0 and S1 event frequencies</strong>, and Waymo makes use of these event
rates for tracking longer-term improvements to the Waymo Driver.</p>
<h3 id="higher-severity-collision-risk">Higher-severity collision
risk</h3>
<p>现有的道路公开测试，无法为 S2 or S3 提供强有力的统计支持。 &gt; 6.1
million miles does not provide statistical power to draw meaningful
conclusions about the frequencies of events of severity S2 or S3.<br />
&gt; MC：目前的测试里程，可以为 Lower-severity
提供支持，但是不能为偶发的 Higher-severity 提供支持，里面有统计噪声
(statistical noise)。<br />
&gt; At this mileage scale, the statistical noise is extremely large and
zero or low event counts only provide <strong>performance
bounds</strong>, which necessitates the consideration of other metrics
to fully assess the safety of the Waymo Driver.</p>
<ol type="1">
<li><p>通过仿真和封闭场测试来评估高风险的表现. &gt; Waymo uses other
methods to evaluate the higher-severity performance, including both
simulation-based and closed-course scenario-based collision-avoidance
testing.</p></li>
<li><p>从低风险事故中发掘高风险事故的信息。 &gt; Low-severity data, when
evaluated in the context of each event’s collision geometry, may be
informative of high-severity risk.</p></li>
</ol>
<h3 id="comparison-benchmarks">Comparison benchmarks</h3>
<p>Human driver collision rates have been widely discussed as providing
a benchmark for AVs.</p>
<p>警方统计的交通事故可能会忽略一部分低风险事件 (non-police-reportable
contact)，所以 police-reported 不足以代表人类的真实事故发生频率。 &gt;
By including low-speed events involving non-police-reportable contact
(e.g. a less than 2 mph vehicle-to-vehicle contact or a pedestrian
walking into the side of a stationary vehicle), <strong>the scope of
events is considerably greater than the scope of police-reported or
insurance-reported collisions commonly used to generate performance
baselines</strong>. <strong>As such, comparing the data presented in
this paper to police-reported collision numbers is not an apt
comparison</strong>.</p>
<p>Obtaining reliable event counts that include such minor events
typically requires <strong>analysis of naturalistic driving
data</strong>.</p>
<h2 id="limitations-and-future-work">Limitations and Future Work</h2>
<p>Limitations related to the statistical power of the mileages reported
have been discussed in the above section on aggregate collision
frequencies. &gt; 即，目前的测试里程，可以为 Lower-severity
提供支持，但是不能为偶发的 Higher-severity 提供支持，里面有统计噪声
(statistical noise)。</p>
<h3 id="limitations-of-counterfactual-simulations">Limitations of
counterfactual simulations</h3>
<ul>
<li><p>反事实仿真只是预测，但不是绝对的准确。 &gt; Due to the nature of
human agent behavior, disengagement simulations are not definitive:
counterfactual simulations predict what could have occurred, but cannot
definitively predict exactly what would have occurred.<br />
&gt; As a result, had the driver not disengaged, some of the reported
simulated collisions may not have actually occurred (e.g. other agents
may have behaved differently). Conversely, other events that, in
simulation did not result in contact, may have actually resulted in
collisions (e.g. if the other agent had been distracted at the critical
moment).</p></li>
<li><p>Waymo therefore takes <strong>a cautious approach</strong> to
interpreting both the outcomes of individual collisions and aggregate
performance metrics, and <strong>considers them in the context of other
indicators of AV performance</strong>.</p></li>
</ul>
<h3 id="secondary-collision-in-simulated-events">Secondary collision in
simulated events</h3>
<p><strong>The severities ascribed to the simulated collisions are based
on the single impact depicted in the simulation</strong>. Owing to
complexities in accurately modeling post-impact vehicle dynamics (which
may or may not involve subsequent steering and braking maneuvers from
the other vehicle), the outcome of any secondary collisions that might
occur subsequent to the simulated event are not explicitly modeled.</p>
<p>Waymo
的第一次碰撞，可以包含绝大多数的严重事故，二级事故不是很重要；二次碰撞需求显得不是那么紧迫。
&gt; In Waymo’s ODD, the vast majority of primary vehicle-to-vehicle
collisions (99% for all collisions, 95% for fatal collisions)
<strong>included in police-reported crash databases involve either a
single vehicle-to-vehicle collision event or a subsequent collision
event of equal or lesser severity</strong>.</p>
<h3 id="interpreting-disengage-performance">Interpreting disengage
performance</h3>
<p>Waymo 安全驾驶员的避障表现，不代表人类驾驶员的避障表现。 &gt; Care
should be taken in drawing conclusions based on the collision-avoidance
performance of Waymo’s trained operators during disengagements, which
for the reasons described below, is not predictive of the
collision-avoidance performance of the overall population of human
drivers.</p>
<p>Waymo 驾驶员和普通人类驾驶员的区别在哪里呢？</p>
<ol type="1">
<li>受过专业培训： Waymo vehicle operators are selected from a subset of
the driving population with good driving records and receive instruction
specific to Waymo AVs, <strong>defensive driving</strong> training, and
education regarding fatigue.</li>
<li>避免被打扰：When operating a vehicle, strict rules are in place
regarding handheld devices including cell phones and operators are
continually monitored for signs of drowsiness.</li>
<li>注意力更集中：Unlike drivers in human-driven vehicles, while the AV
is in self-driving mode, Waymo’s trained operators do not execute
navigation, path planning, or control tasks, but instead are focused on
monitoring the environment and the Waymo Driver’s response to it.</li>
</ol>
<p>Trained vehicle operators are therefore able to focus their full
attention on being ready to disengage and execute collision avoidance,
and <strong>their performance at this task is expected to be superior to
that of a human in a traditional driving role</strong>.</p>
<h3 id="future-work">Future work</h3>
<p>We expect and invite other safety researchers to review the events
and mileages presented here and make their own findings regarding the
safety performance of Waymo’s operations demonstrated in this data.</p>
<!--
总体感觉羞羞答答，不给全部的数据，告诉你做也不合理，该自己充分的解释余地。
-->
<h1 id="conclusion">Conclusion</h1>
<p>Taken together, these 47 lower severity (S0 and S1) events (18 actual
and 29 simulated, one during driverless operation) show
<strong>significant contribution from other agents</strong>, namely
human-related deviations from traffic rules and safe driving
performance.</p>
<p>The frequency of challenging events that were induced by incautious
behaviors of other drivers serves as a clear reminder of <strong>the
challenges in collision avoidance so long as AVs share roadways with
human drivers</strong>.</p>
<p>由其他司机不谨慎行为诱发的事故频率清楚地提醒人们，只要自动驾驶汽车与人类司机共享道路，避免碰撞就是一大挑战。只要和人类共享道路
(share roads)，完全安全的自动驾驶是不可行的，需要降低过高的期望
(inflated expectations)。 &gt; Statistics regarding the high percentage
of human collisions that are attributed to human error may lead to
inflated expectations of the potential immediate safety benefits of AVs.
AVs will share roads with human drivers for the foreseeable future, and
significant numbers of collisions due to human driver errors that are
simply <strong>unavoidable</strong> should be expected during this
period.</p>
<ul>
<li><p>和人类现有数据比较，碰撞分布发生变化；可以认清楚自动驾驶的优点
(机器稳定以及不知疲倦)以及劣势，优点可以及早加以利用，但是如何规避缺点却是一个难点。
&gt; Due to the typology of those collisions initiated by other actors
as well as the Waymo Driver’s proficiency in avoiding certain collision
modes, the data presented shows <strong>a significant shift</strong> in
the relative distributions of collision types as compared to national
crash statistics for human drivers.</p></li>
<li><p>这是业界首次发布百万英里自动驾驶中的碰撞事故。评估自动驾驶汽车安全性没有标准的方法，Waymo
作为行业领头羊的担当，希望通过公布这些数据，推动政策制定者、研究人员甚至其他公司承担制定通用框架的任务。
&gt; This is the first time that information on every actual and
simulated collision or contact has been shared for millions of miles of
automated driving.<br />
&gt; The most significant long-term contributions of this paper will
likely not be the actual data shared, but the example set by publicly
sharing this type of safety performance data and the dialogs that this
paper fosters.</p></li>
</ul>
<h1 id="references">References</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/PI0W_bJJ_Jwc2YncOJgexA">新智驾
Waymo 路测报告</a></li>
<li><a
target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/fxHBBZG51b7yS4dBfcY39g">Waymo“自曝家丑”，首发最详细自动驾驶报告</a></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Weekly-Blogs/" rel="tag"># Weekly Blogs</a>
          
            <a href="/tags/Robotics/" rel="tag"># Robotics</a>
          
            <a href="/tags/Paper/" rel="tag"># Paper</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Reading/expression-on-simple-life/" rel="next" title="不持有的生活 读后感">
                <i class="fa fa-chevron-left"></i> 不持有的生活 读后感
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Linux/linux-interminal-shortcut-cmd/" rel="prev" title="Linux 终端">
                Linux 终端 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">94</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/wylloong" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yanlong.wangchn@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%93%E4%B8%9A%E5%90%8D%E8%AF%8D%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">专业名词介绍</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#abstract"><span class="nav-number">2.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#introduction"><span class="nav-number">3.</span> <span class="nav-text">Introduction</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#public-road-testing"><span class="nav-number">3.1.</span> <span class="nav-text">Public Road Testing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#the-role-of-counterfactual-what-if-simulation"><span class="nav-number">3.2.</span> <span class="nav-text">The Role of
Counterfactual (“What If”) Simulation</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#aims-and-contributions-of-this-paper"><span class="nav-number">3.3.</span> <span class="nav-text">Aims and Contributions of
this Paper</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#methods"><span class="nav-number">4.</span> <span class="nav-text">Methods</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#data-sources"><span class="nav-number">4.1.</span> <span class="nav-text">Data sources</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#data-from-actual-collisions-and-minor-contacts"><span class="nav-number">4.2.</span> <span class="nav-text">Data from Actual
Collisions and Minor Contacts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#data-from-counterfactual-what-if-simulation"><span class="nav-number">4.3.</span> <span class="nav-text">Data from
Counterfactual (“What If”) Simulation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#simulation-of-the-av-motion-post-disengagement"><span class="nav-number">4.3.1.</span> <span class="nav-text">Simulation of
the AV motion post-disengagement</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#modeling-of-other-agents"><span class="nav-number">4.3.2.</span> <span class="nav-text">Modeling of other agents</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#contact-analysis-of-simulated-collisions"><span class="nav-number">4.3.3.</span> <span class="nav-text">Contact analysis of
simulated collisions</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#results-collisions-and-minor-contacts"><span class="nav-number">5.</span> <span class="nav-text">Results: Collisions and
Minor Contacts</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#single-vehicle-events"><span class="nav-number">5.1.</span> <span class="nav-text">Single Vehicle Events</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multiple-vehicle-events-reversing-reversing"><span class="nav-number">5.2.</span> <span class="nav-text">Multiple Vehicle
Events: Reversing Reversing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multiple-vehicle-events-same-direction-sideswipe"><span class="nav-number">5.3.</span> <span class="nav-text">Multiple
Vehicle Events: Same Direction Sideswipe</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#other-vehicle-changing-lanes-waymo-vehicle-straight"><span class="nav-number">5.3.1.</span> <span class="nav-text">Other
vehicle changing lanes, Waymo vehicle straight</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#other-vehicle-straight-waymo-vehicle-changing-lanes"><span class="nav-number">5.3.2.</span> <span class="nav-text">Other
vehicle straight, Waymo vehicle changing lanes</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multiple-vehicle-events-head-on-or-opposite-direction-sideswipe"><span class="nav-number">5.4.</span> <span class="nav-text">Multiple
Vehicle Events: Head-on or Opposite Direction Sideswipe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multiple-vehicle-events-rear-end"><span class="nav-number">5.5.</span> <span class="nav-text">Multiple Vehicle Events: Rear
End</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#rear-end-struck-event-group-waymo-vehicle-stopped-or-gradually-decelerating-for-traffic-controls-or-traffic-ahead-while-traveling-straight"><span class="nav-number">5.5.1.</span> <span class="nav-text">Rear
end struck event group, Waymo vehicle stopped or gradually decelerating
for traffic controls or traffic ahead while traveling straight</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rear-end-struck-event-group-waymo-vehicle-moving-slower-while-traveling-straight"><span class="nav-number">5.5.2.</span> <span class="nav-text">Rear
end struck event group, Waymo vehicle moving slower while traveling
straight</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rear-end-struck-event-group-in-right-turning-maneuvers"><span class="nav-number">5.5.3.</span> <span class="nav-text">Rear end
struck event group in right turning maneuvers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rear-end-struck-event-with-braking-of-lead-vehicle-during-left-turn"><span class="nav-number">5.5.4.</span> <span class="nav-text">Rear
end struck event with braking of lead vehicle during left turn</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#rear-end-striking-event"><span class="nav-number">5.5.5.</span> <span class="nav-text">Rear end striking event</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multiple-vehicle-events-angled"><span class="nav-number">5.6.</span> <span class="nav-text">Multiple Vehicle Events:
Angled</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#angled-event-group-with-the-other-vehicle-not-yielding-to-waymo-right-of-way"><span class="nav-number">5.6.1.</span> <span class="nav-text">Angled
event group with the other vehicle not yielding to Waymo
right-of-way</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#angled-event-group-with-waymo-vehicle-crossing-another-vehicles-path"><span class="nav-number">5.7.</span> <span class="nav-text">Angled
event group with Waymo vehicle crossing another vehicle’s path</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#discussion"><span class="nav-number">6.</span> <span class="nav-text">Discussion</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#collision-avoidance-management-of-human-driver-related-contributing-factors"><span class="nav-number">6.1.</span> <span class="nav-text">Collision
Avoidance: Management of Human-Driver-Related Contributing Factors</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#aggregate-safety-performance"><span class="nav-number">6.2.</span> <span class="nav-text">Aggregate Safety Performance</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#lower-severity-collision-risk"><span class="nav-number">6.2.1.</span> <span class="nav-text">Lower-severity collision
risk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#higher-severity-collision-risk"><span class="nav-number">6.2.2.</span> <span class="nav-text">Higher-severity collision
risk</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#comparison-benchmarks"><span class="nav-number">6.2.3.</span> <span class="nav-text">Comparison benchmarks</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#limitations-and-future-work"><span class="nav-number">6.3.</span> <span class="nav-text">Limitations and Future Work</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#limitations-of-counterfactual-simulations"><span class="nav-number">6.3.1.</span> <span class="nav-text">Limitations of
counterfactual simulations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#secondary-collision-in-simulated-events"><span class="nav-number">6.3.2.</span> <span class="nav-text">Secondary collision in
simulated events</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#interpreting-disengage-performance"><span class="nav-number">6.3.3.</span> <span class="nav-text">Interpreting disengage
performance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#future-work"><span class="nav-number">6.3.4.</span> <span class="nav-text">Future work</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#conclusion"><span class="nav-number">7.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#references"><span class="nav-number">8.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nobody</span>

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
