<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />




<!-- waylon's adsense -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6129496365361356"
     crossorigin="anonymous"></script>













  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Paper,BTC," />










<meta name="description" content="[toc]  在 2008 年，比特币创始人 中本聪 (Satoshi Nakamoto) 发表了这篇可以载入史册的论文 - 比特币：一种点对点的电子现金系统 (Bitcoin: A Peer-to-Peer Electronic Cash System)，讲述了比特币是如何产生和工作的。 官网下载链接是 white paper，其中有多种语言的翻译版。建议有英文阅读能力的同学，优先选择英文原版阅">
<meta property="og:type" content="article">
<meta property="og:title" content="解读 A Peer-to-Peer Electronic Cash System">
<meta property="og:url" content="http://www.waylon.one/BTC/A-Peer-to-Peer-Electronic-Cash-System/index.html">
<meta property="og:site_name" content="One&#39;s Way">
<meta property="og:description" content="[toc]  在 2008 年，比特币创始人 中本聪 (Satoshi Nakamoto) 发表了这篇可以载入史册的论文 - 比特币：一种点对点的电子现金系统 (Bitcoin: A Peer-to-Peer Electronic Cash System)，讲述了比特币是如何产生和工作的。 官网下载链接是 white paper，其中有多种语言的翻译版。建议有英文阅读能力的同学，优先选择英文原版阅">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-02-21T07:32:07.000Z">
<meta property="article:modified_time" content="2023-05-19T12:12:32.149Z">
<meta property="article:author" content="Nobody">
<meta property="article:tag" content="Paper">
<meta property="article:tag" content="BTC">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.waylon.one/BTC/A-Peer-to-Peer-Electronic-Cash-System/"/>





  <title>解读 A Peer-to-Peer Electronic Cash System | One's Way</title>
  








<meta name="generator" content="Hexo 6.3.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">One's Way</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Dare to create</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.waylon.one/BTC/A-Peer-to-Peer-Electronic-Cash-System/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="One's Way">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">解读 A Peer-to-Peer Electronic Cash System</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2021-02-21T15:32:07+08:00">
                2021-02-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/BTC/" itemprop="url" rel="index">
                    <span itemprop="name">BTC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  15k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  55 mins.
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[toc]</p>
<!--
解读 Bitcoin: A Peer-to-Peer Electronic Cash System
-->
<p>在 2008 年，比特币创始人 中本聪 (Satoshi Nakamoto)
发表了这篇可以载入史册的论文 - 比特币：一种点对点的电子现金系统
(Bitcoin: A Peer-to-Peer Electronic Cash
System)，讲述了比特币是如何产生和工作的。</p>
<p>官网下载链接是 <a target="_blank" rel="noopener" href="https://bitcoin.org/en/bitcoin-paper">white
paper</a>，其中有多种语言的翻译版。建议有英文阅读能力的同学，优先选择英文原版阅读。</p>
<p>比特币涉及到计算机原理、密码学、概率学等复杂的知识。如果想彻底搞懂比特币原理，光看这一篇论文显然是不够的，还需要大量的衍生阅读。这篇文章的起点门槛比较高，但是这篇文章是学习比特币原理，最权威、第一手的资料，能让你对比特币的设计原理有大体的了解，体会
中本聪 设计比特币的初衷。</p>
<p>如果你想参与比特币等数字货币的交易，那么欢迎移步阅读我的另一篇教程文章
- <a
target="_blank" rel="noopener" href="http://waylon.one/monthly-skills/buy-one-bitcoin/">购买自己的第一枚数字货币</a>。</p>
<h1 id="abstract">Abstract</h1>
<p>中本聪设计比特币的目的：通过构建完全点对点技术，实现一种电子货币，达到<strong>无需金融中介</strong>，<strong>无需双方信任</strong>的情况下，实现在线的电子化支付。</p>
<blockquote>
<p>A purely peer-to-peer version of electronic cash would allow online
payments to be sent directly from one party to another without going
through a financial institution.</p>
</blockquote>
<p>论文的主要成就：使用点对点的技术，在不依赖第三方交易平台 (financial
institution, a trusted third party)
的情况下，利用区块链技术，实现了去中心化的目的，解决了双重支付
(double-spending) 问题。</p>
<blockquote>
<p>Digital signatures provide part of the solution, but the main
benefits are lost if a trusted third party is still required to prevent
double-spending. We propose a solution to the double-spending problem
using a peer-to-peer network.</p>
</blockquote>
<p>中本聪通过数字签名 (digital signatures)，随机散列，哈希算法
(hash)，工作量证明 (proof-of-work, POW)，动态链式存储 (ongoing chain)
等技术，设计了一系列的机制，使比特币能够解决电子支付中的双花难题
(double-spending)，记录篡改等问题，并最终通过严密的数学论证，证明该系统安全有效，稳定可行。</p>
<h1 id="introduction">Introduction</h1>
<p>目前互联网贸易越来越依赖金融机构作为可信任的第三方，那么完全的不可撤销交易实际上是不存在的；那么对不可撤销服务进行支付将需要更大的成本，比如索取付款方更多的个人信息，我们迫切需要在不引入一个可信任方而能在通信通道上进行支付的机制。</p>
<p>本文提出一个基于密码学原理，而不是信任的电子支付系统，该系统允许任何有意愿的双方能直接交易而不需要一个可信任第三方。</p>
<blockquote>
<p>What is needed is an electronic payment system based on cryptographic
proof instead of trust, allowing any two willing parties to transact
directly with each other without the need for a trusted third party.</p>
</blockquote>
<p>本文提出的比特币系统，具有以下三个优点： -
基于密码学原理，而不是信任来建立支付系统。 * based on cryptogtaphic
proof instead of trust - 不需要引入第三方金融机构。 * without third
party financial institutions - 交易不可逆。 * no reverse
transactions</p>
<h1 id="transactions">Transactions</h1>
<!--
如何完成收付款，验证交易有效性，以及存储交易记录，是
-->
<p>我们定义一枚电子货币就是一条数字签名链。 &gt; We define an electronic
coin as a chain of digital signatures.</p>
<p>每个拥有者都通过将上一次交易和<strong>下一个拥有者的公钥</strong>的哈希值的<strong>数字签名</strong>添加到此货币末尾的方式将这枚货币转移给下一个拥有者。收款人可以通过验证数字签名来证实其为该链的所有者。</p>
<blockquote>
<p>Each owner transfers the coin to the next by digitally signing a hash
of the previous transaction and the public key of the next owner and
adding these to the end of the coin. A payee can verify the signatures
to verify the chain of ownership.</p>
</blockquote>
<p><img
src="http://www.waylon.one/downloads/images/blog/BTC_WhitePaper_Signatures.PNG" /></p>
<p>知识点：哈希（Hash）是将目标文本转换成具有<strong>相同长度</strong>的、<strong>不可逆</strong>的杂凑字符串（或叫做消息摘要），而加密（Encrypt）是将目标文本转换成具有<strong>不同长度</strong>的、<strong>可逆</strong>的密文。</p>
<p>到目前为止，有一个问题需要解决，那就是"收款人不能证实拥有者之一没有对此货币进行双重支付"，也就是一份钱付给了两个人，这也是后面文章中要解决的主要问题。</p>
<blockquote>
<p>The problem of course is the payee can't verify that one of the
owners did not double-spend the coin.</p>
</blockquote>
<h1 id="timestamp-server">Timestamp Server</h1>
<p>时间戳服务器计算包含多个需要被打时间戳的数据项的区块的哈希值，并<strong>广泛地发布公开</strong>这个哈希值。</p>
<blockquote>
<p>A timestamp server works by taking a hash of a block of items to be
timestamped and widely publishing the hash.</p>
</blockquote>
<p>时间服务器，类似于一个交易编年史，把一次次交易按时间顺序记录下来，形成一个个区块链，并为公众所知晓。</p>
<h1 id="proof-of-work">Proof-Of-Work</h1>
<p>工作量证明要解决的问题：采取搜索一个数，使得被哈希时 (如使用
SHA-256)，得到的哈希值以数个 0 比特开始。</p>
<p>平均所需工作量将随所需 0
比特呈指数级增长，而验证却只需执行一次哈希。一般情况下，10 min
求解出一次答案，也就是挖矿的过程。</p>
<blockquote>
<p>The proof-of-work involves scanning for a value that when hashed,
such as with SHA-256, the hash begins with a number of zero bits. The
average work required is exponential in the number of zero bits required
and can be verified by executing a single hash.</p>
</blockquote>
<p>POW 约束：当前区块包含了上一区块的 hash
值，从而形成带时间戳、可验证的链式结构；一旦消耗了 CPU
算力使区块满足了工作量证明，那么除非重做这个工作否则就无法更改区块。由于后面的区块是链接在这个区块后面的，改变这个区块将需要重做所有后面的区块。</p>
<blockquote>
<p>Once the CPU effort has been expended to make it satisfy the
proof-of-work, the block cannot be changed without redoing the work. As
later blocks are chained after it, the work to change the block would
include redoing all the blocks after it.</p>
</blockquote>
<p>POW 特点：按 CPU 投票，解决了多数决定中的确定方式问题 (the problem of
determining representation in majority decision
making)。最长的链代表了多数决定，因为有最大的计算工作量证明的精力投入到这条链上。</p>
<blockquote>
<p>Proof-of-work is essentially one-CPU-one-vote. The majority decision
is represented by the longest chain, which has the greatest
proof-of-work effort invested in it.</p>
</blockquote>
<p>POW
算力限制：为了抵消<strong>硬件运算速度的增加</strong>(摩尔定律)及平衡不同时期运行节点的利益，工作量证明的难度将由移动平均数法来确定每小时生成区块的平均数。如果区块生成得过快，那么生成的难度就会增加。</p>
<p>MC：BTC 是一个复杂系统，在设计之初，就详细考虑了方方面面。</p>
<blockquote>
<p>To compensate for increasing hardware speed and varying interest in
running nodes over time, the proof-of-work difficulty is determined by a
moving average targeting an average number of blocks per hour. If
they're generated too fast, the difficulty increases.</p>
</blockquote>
<h1 id="network">Network</h1>
<h2 id="分布式网络的运行步骤">分布式网络的运行步骤</h2>
<ol type="1">
<li>新交易向所有节点广播。</li>
</ol>
<!--
广播丢失了怎么办？
-->
<ol start="2" type="1">
<li>每个节点将新交易收集到一个区块。</li>
<li>每个节点为它的区块寻找工作量证明。</li>
<li>当一个节点找到了工作量证明，就向所有节点广播这个区块。</li>
<li>节点只有在区块内所有交易都是有效的且之前没有被支付的情况下接收这个区块。</li>
</ol>
<!--
验证工作量证明是否符合，没有被恶意篡改；验证没有付款方恶意的双重支付的问题。
-->
<ol start="6" type="1">
<li>节点通过使用这个区块的哈希值作为上一个哈希值，在链中创建下一个区块的方式表示对这个区块的接受。</li>
</ol>
<p>根据规定，节点总是认为最长的链为正确的并持续致力于延长它。</p>
<blockquote>
<p>Nodes always consider the longest chain to be the correct one and
will keep working on extending it.</p>
</blockquote>
<h2 id="网络的鲁棒性">网络的鲁棒性</h2>
<ol type="1">
<li>新交易的广播不必到达所有的节点。</li>
</ol>
<ul>
<li>只要到达一些节点，不久就会进入到一个区块。</li>
</ul>
<ol start="2" type="1">
<li>区块广播也是能容忍消息丢失的。</li>
</ol>
<ul>
<li>如果一个节点没有收到某个区块，它将在收到下一个区块时发现它丢失了一个区块然后去请求这个区块。</li>
</ul>
<blockquote>
<p>New transaction broadcasts do not necessarily need to reach all
nodes. As long as they reach many nodes, they will get into a block
before long. Block broadcasts are also tolerant of dropped messages. If
a node does not receive a block, it will request it when it receives the
next block and realizes it missed one.</p>
</blockquote>
<h1 id="incentive">Incentive</h1>
<h2 id="激励组成">激励组成</h2>
<p>我们约定，区块中的第一笔交易是特殊的交易，奖励区块创建者一枚属于 TA
的新货币
(挖矿收益)。这就增加了对支持网络的节点的激励，并提供了一种分发货币到流通领域的方法。
* BTC 消耗 CPU 计算时间和电力 (CPU time and electricity)
资源来稳定地增加新货币，替代了中心发币机构。</p>
<blockquote>
<p>By convention, the first transaction in a block is a special
transaction that starts a new coin owned by the creator of the block.
This adds an incentive for nodes to support the network, and provides a
way to initially distribute coins into circulation, since there is no
central authority to issue them.</p>
</blockquote>
<p>激励也可以由交易费充当。如果交易的输出值小于其输入值，差价就作为交易费被加到<strong>包含此交易的区块的激励</strong>中。一旦预定量的货币进入了流通领域，激励将变为只含有交易费，这样可以完全避免通货膨胀。</p>
<p>所以，区块奖励 = 区块新货币奖励 (若有，奖励逐渐减少) +
区块包含交易中的手续费奖励。</p>
<blockquote>
<p>The incentive can also be funded with transaction fees. If the output
value of a transaction is less than its input value, the difference is a
transaction fee that is added to the incentive value of the block
containing the transaction.</p>
</blockquote>
<p>激励会有助于鼓励节点保持诚实，遵守规则比破坏系统和他自己财产的有效性更有利。</p>
<blockquote>
<p>The incentive may help encourage nodes to stay honest. He ought to
find it more profitable to play by the rules, such rules that favour him
with more new coins than everyone else combined, than to undermine the
system and the validity of his own wealth.</p>
</blockquote>
<h1 id="reclaiming-disk-space">Reclaiming Disk Space</h1>
<p>一旦某个货币的最新交易已经被足够多的区块覆盖，这之前的支付交易就可以被丢弃以<strong>节省磁盘空间</strong>。
* 老的交易被哈希进默克尔树 (Merkle Tree)
(树枝内部的哈希不需要被保存)，只有根节点被纳入到区块的哈希值，那么老的区块可通过剪除树枝的方式被压缩，又不破坏区块的哈希值。</p>
<blockquote>
<p>Once the latest transaction in a coin is buried under enough blocks,
the spent transactions before it can be discarded to save disk
space.</p>
</blockquote>
<p>分布式存储可行性论证：每个不包含交易信息的区块头大约是 80
bytes。如果每 10 分钟生成一个区块，每年生成 80 bytes * 6 * 24 * 365 =
4.2 MB。</p>
<blockquote>
<p>A block header with no transactions would be about 80 bytes. If we
suppose blocks are generated every 10 minutes, 80 bytes * 6 * 24 * 365 =
4.2MB per year.</p>
</blockquote>
<h1 id="simplified-payment-verification">Simplified Payment
Verification</h1>
<p>不运行一个完整的网络节点也是可以进行支付验证的。用户只需拥有一个最长工作量证明链的区块头副本，他可以通过向其他网络节点查询以确认他拥有了最长的链，并获取链接该交易到给交易打时间戳区块的默克尔分支。</p>
<blockquote>
<p>It is possible to verify payments without running a full network
node. A user only needs to keep a copy of the block headers of the
longest proof-of-work chain, which he can get by querying network nodes
until he's convinced he has the longest chain, and obtain the Merkle
branch linking the transaction to the block it's timestamped in.</p>
</blockquote>
<p>虽然收款方自己不能核实这个交易
(零知识证明)，但如果交易已经链接到链中的某个位置，就说明一个网络节点已经接受了此交易，而其后迫加的区块进一步确认网络已经接受了它。</p>
<blockquote>
<p>He can't check the transaction for himself, but by linking it to a
place in the chain, he can see that a network node has accepted it, and
blocks added after it further confirm the network has accepted it.</p>
</blockquote>
<p>缺陷：同样地，只要诚实节点控制着网络，这种简化验证就是可靠的；如果网络被攻击者控制，简化验证
(SPV)
会变得比较脆弱。虽然网络节点可以验证他们自己的交易，但只要攻击者持续控制网络那么这种简化的方法就可能被攻击者的伪造交易欺骗。比如，SPV
钱包(轻钱包)存在一定的安全隐患。</p>
<blockquote>
<p>As such, the verification is reliable as long as honest nodes control
the network, but is more vulnerable if the network is overpowered by an
attacker.</p>
</blockquote>
<p>为了更加独立的安全性以及更快的支付确认，收款频繁的公司可能仍需运行他们自己的节点。</p>
<blockquote>
<p>Businesses that receive frequent payments will probably still want to
run their own nodes for more independent security and quicker
verification.</p>
</blockquote>
<h1 id="combining-and-splitting-value">Combining and Splitting
Value</h1>
<p>为允许交易额被分割和合并，交易将包含多个输入值和输出值。
通常是一个从之前交易而得的较大输入值或多个较小输入值的组合，以及最多两个输出值：一个作为支付，另一个作为找零，如果有的话，退还给支付发送方。</p>
<blockquote>
<p>To allow value to be split and combined, <strong>transactions contain
multiple inputs and outputs</strong>. Normally there will be either a
single input from a larger previous transaction or multiple inputs
combining smaller amounts, and <strong>at most two outputs</strong>: one
for the payment, and one returning the change, if any, back to the
sender.</p>
</blockquote>
<h1 id="privacy">Privacy</h1>
<h2 id="如何保护隐私">如何保护隐私？</h2>
<p><img
src="http://www.waylon.one/downloads/images/blog/BTC_WhitePaper_Privacy.PNG" /></p>
<p>如上图，不同于传统的银行模型(通过限制参与方和可信任第三方对信息的访问来达到一定级别的隐私)，BTC
交易通过保持<strong>公钥匿名</strong> (public keys anonymous)
来保证用户信息的隐私。 *
公众能看到有人正在发送一定量货币给其他人，但是不能将交易关联到某个人，可以类比于证券交易。</p>
<!--
![BTC_WhitePaper_Privacy](AEF5223F2C6D43BE8BCDEE3DF6317CF1)
-->
<blockquote>
<p>The necessity to announce all transactions publicly precludes this
method, but privacy can still be maintained by breaking the flow of
information in another place: by keeping public keys anonymous. The
public can see that someone is sending an amount to someone else, but
without information linking the transaction to anyone.</p>
</blockquote>
<h2 id="又一层隐私保障">又一层隐私保障</h2>
<p>作为额外的防火墙，对每笔交易使用<strong>新密钥</strong> (new key
pair) 对可以防止他们被关联到一个共同的拥有者。</p>
<blockquote>
<p>As an additional firewall, a new key pair should be used for each
transaction to keep them from being linked to a common owner.</p>
</blockquote>
<p>新秘钥泄露隐私风险：由于多输入值交易存在，有些关联仍不可避免，因为<strong>多输入值交易必然暴露其多个输入是属于同一个拥有者的</strong>。风险就在于如果一个密钥的拥有者被暴露，关联性将暴露其他属于同一个拥有者的交易。所以，BTC
交易虽然是支持匿名的，但是不能杜绝通过关联性来获知用户<strong>交易信息</strong>。</p>
<blockquote>
<p>Some linking is still unavoidable with multi-input transactions,
which necessarily reveal that <strong>their inputs were owned by the
same owner</strong>. The risk is that if the owner of a key is revealed,
linking could reveal other transactions that belonged to the same
owner.</p>
</blockquote>
<h1 id="calculations">Calculations</h1>
<h2 id="攻击者的收益">攻击者的收益</h2>
<p>假设一个攻击者生成一条比诚实链更快的替代链，那么系统也不会变得可以任意修改。这种情况下，攻击者既不能凭空创建货币，也拿不走不属于他的钱，因为<strong>网络节点将不会接受无效的交易作为支付，而且诚实节点永远不会接受一个包含无效交易的区块</strong>。<strong>攻击者只可能改变他自己的某笔交易来拿回他不久前已经支出的钱</strong>。</p>
<!--
有没有一种可能，攻击者根本不是为了盈利，而是破坏系统，破坏数学的信任感。
-->
<blockquote>
<p>An attacker can only try to change one of his own transactions to
take back money he <strong>recently</strong> spent.</p>
</blockquote>
<p>攻击者从某一落后位置赶上诚实链的概率类似于赌徒破产理论 (a Gambler's
Ruin problem)，本节主要建立概率模型来估算攻击者赶上诚实链的概率。</p>
<blockquote>
<p>The probability of an attacker catching up from a given deficit is
analogous to a Gambler's Ruin problem.</p>
</blockquote>
<p>省略数学推导及证明...</p>
<p>概率证明的结论：攻击者的虚假链能赶上 z 个诚实区块的概率，随 z
的增长呈指数下降。</p>
<h1 id="conclusion">Conclusion</h1>
<p>我们已经提出了一种<strong>不依赖信任</strong>的电子交易系统。我们从通用的数字签名货币体系开始，这体系提供了<strong>强有力的所有权控制</strong>，但由于缺乏防止双重支付的方法而不完善。</p>
<p>为解决这个问题，我们提出<strong>一种使用工作量证明来记录公共交易历史的点对点网络</strong>，只要诚实节点控制了多数的
CPU 算力，对于对攻击者，交易历史将很快变得在计算上不可更改。</p>
<p>网络因其结构简洁性而健壮。节点只需很少的协调就能同时工作。它们不需要被认证，因为信息不会被发送到某个特殊的位置，<strong>只需被尽力传播</strong>。节点可以随时离开和重新加入网络，只需接受最长的工作量证明链作为它们离开时发生事件的证据。</p>
<p>节点使用 CPU
算力来投票，通过致力于延长有效区块来表达对其接受，通过拒绝在无效区块上工作来表达对其抵制。任何需要的规则和激励都可通过这个共识机制来加强。</p>
<blockquote>
<p>We have proposed a system for electronic transactions without relying
on trust. We started with the usual framework of coins made from digital
signatures, which provides strong control of ownership, but is
incomplete without a way to prevent double-spending. To solve this, we
proposed a peer-to-peer network using proof-of-work to record a public
history of transactions that quickly becomes computationally impractical
for an attacker to change if honest nodes control a majority of CPU
power. The network is robust in its unstructured simplicity. Nodes work
all at once with little coordination. They do not need to be identified,
since messages are not routed to any particular place and only need to
be delivered on a best effort basis. Nodes can leave and rejoin the
network at will, accepting the proof-of-work chain as proof of what
happened while they were gone. They vote with their CPU power,
expressing their acceptance of valid blocks by working on extending them
and rejecting invalid blocks by refusing to work on them. Any needed
rules and incentives can be enforced with this consensus mechanism.</p>
</blockquote>
<p>我的评价：BTC
系统是站在巨人的肩膀上实现，是一种去中心化，分布式的的经济学。首先，数字签名货币体系是已经通用的，但是有明显的双重支付缺陷没有被很好地解决。基于工作量证明的已有研究，作者提出
P2P 交易记账系统，根据 CPU 算力来模拟投票 和
筛选出诚实节点，并且把最长的工作量证明链作为交易账单；各个节点通过致力于延长有效区块来表达对其接受，通过拒绝在无效区块上工作来表达对其抵制；通过挖矿奖励的形式，鼓励了数字货币交易的普及，以及各节点的记账积极性。</p>
<p>论文构建的区块链模型，给科技界带来了一种思想变革，必将颠覆一些行业；BTC
只是区块链的一个应用，而不只是区块链的全部。</p>
<h1 id="references">References</h1>
<ul>
<li><a target="_blank" rel="noopener" href="https://explorer.btc.com/btc/home">BTC 浏览器</a></li>
<li><a
target="_blank" rel="noopener" href="https://www.blockchain.com/explorer?utm_campaign=dcomnav_explorer">BTC
交易浏览器</a></li>
<li><a
target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Hh411Z7id">读懂比特币白皮书，区块链开山之作，中本聪到底说了什么？</a>
<ul>
<li>非常好的视频讲解，带你快速了解白皮书。</li>
</ul></li>
</ul>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Paper/" rel="tag"># Paper</a>
          
            <a href="/tags/BTC/" rel="tag"># BTC</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Finance/nobody-s-2020-finance-summary/" rel="next" title="小人物的 2020 理财总结">
                <i class="fa fa-chevron-left"></i> 小人物的 2020 理财总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/Autonomous-Driving/Baidu-Apollo-EM-Motion-Planner/" rel="prev" title="解读 Baidu Apollo EM Motion Planner">
                解读 Baidu Apollo EM Motion Planner <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">94</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">38</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/waylondotone" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:me@waylon.one" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#abstract"><span class="nav-number">1.</span> <span class="nav-text">Abstract</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#introduction"><span class="nav-number">2.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#transactions"><span class="nav-number">3.</span> <span class="nav-text">Transactions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#timestamp-server"><span class="nav-number">4.</span> <span class="nav-text">Timestamp Server</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#proof-of-work"><span class="nav-number">5.</span> <span class="nav-text">Proof-Of-Work</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#network"><span class="nav-number">6.</span> <span class="nav-text">Network</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E8%BF%90%E8%A1%8C%E6%AD%A5%E9%AA%A4"><span class="nav-number">6.1.</span> <span class="nav-text">分布式网络的运行步骤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E7%9A%84%E9%B2%81%E6%A3%92%E6%80%A7"><span class="nav-number">6.2.</span> <span class="nav-text">网络的鲁棒性</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#incentive"><span class="nav-number">7.</span> <span class="nav-text">Incentive</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BF%80%E5%8A%B1%E7%BB%84%E6%88%90"><span class="nav-number">7.1.</span> <span class="nav-text">激励组成</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#reclaiming-disk-space"><span class="nav-number">8.</span> <span class="nav-text">Reclaiming Disk Space</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#simplified-payment-verification"><span class="nav-number">9.</span> <span class="nav-text">Simplified Payment
Verification</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#combining-and-splitting-value"><span class="nav-number">10.</span> <span class="nav-text">Combining and Splitting
Value</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#privacy"><span class="nav-number">11.</span> <span class="nav-text">Privacy</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%BF%9D%E6%8A%A4%E9%9A%90%E7%A7%81"><span class="nav-number">11.1.</span> <span class="nav-text">如何保护隐私？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%88%E4%B8%80%E5%B1%82%E9%9A%90%E7%A7%81%E4%BF%9D%E9%9A%9C"><span class="nav-number">11.2.</span> <span class="nav-text">又一层隐私保障</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#calculations"><span class="nav-number">12.</span> <span class="nav-text">Calculations</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%BB%E5%87%BB%E8%80%85%E7%9A%84%E6%94%B6%E7%9B%8A"><span class="nav-number">12.1.</span> <span class="nav-text">攻击者的收益</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#conclusion"><span class="nav-number">13.</span> <span class="nav-text">Conclusion</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#references"><span class="nav-number">14.</span> <span class="nav-text">References</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2019 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Nobody</span>

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  

</body>
</html>
